# PostgreSQL Configuration
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres123
POSTGRES_DB=requirementsdb
POSTGRES_SCHEMA=public
POSTGRES_POOL_SIZE=5
POSTGRES_MAX_OVERFLOW=10
POSTGRES_POOL_TIMEOUT=30
POSTGRES_POOL_RECYCLE=1800

# Neo4j Configuration
NEO4J_URI=bolt://neo4j:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=neo4j123
NEO4J_DATABASE=neo4j
NEO4J_CONNECTION_TIMEOUT=30.0
NEO4J_MAX_RETRY_ATTEMPTS=3
NEO4J_RETRY_DELAY=2.0
NEO4J_MAX_CONNECTION_POOL_SIZE=50
NEO4J_MAX_TRANSACTION_RETRY_TIME=30.0

# Redis Configuration
REDIS_URL=redis://redis:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_MAX_CONNECTIONS=10
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_CONNECT_TIMEOUT=5.0
REDIS_SOCKET_TIMEOUT=5.0

# Redis Pub/Sub Configuration
REDIS_PUBSUB_CHANNEL_PREFIX=project_progress
REDIS_PUBSUB_MAX_CONNECTIONS=5
REDIS_PUBSUB_CONNECTION_TIMEOUT=10.0
REDIS_PUBSUB_RETRY_ATTEMPTS=3
REDIS_PUBSUB_RETRY_DELAY=2.0

# Celery Configuration
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Common Retry/Backoff Settings
RETRY_MAX_ATTEMPTS=3
RETRY_BACKOFF_BASE_SEC=2
RETRY_BACKOFF_FACTOR=2
RETRY_BACKOFF_MAX_SEC=60

# HTTP Client Configuration
PROJECT_MANAGEMENT_SERVICE_URL=http://project-management-service:8000

OAI_KEY=KEY
OAI_MODEL=gpt-4.1
OAI_EMBED_MODEL=text-embedding-3-small
OAI_BASE_URL=http://openai-mock-service:8000
OAI_API_VERSION=2024-02-15-preview
OAI_EMBED_BATCH=16
OAI_EMBED_CONCURRENCY=2

# GraphRAG Concurrency/Throttling
GRAPHRAG_ASYNC_MODE=threaded
GRAPHRAG_LLM_THREAD_COUNT=16
GRAPHRAG_LLM_THREAD_STAGGER=0.2
GRAPHRAG_LLM_CONCURRENT_REQUESTS=12
GRAPHRAG_LLM_TOKENS_PER_MINUTE=100000
GRAPHRAG_LLM_REQUESTS_PER_MINUTE=60
GRAPHRAG_EMBEDDING_THREAD_COUNT=16
GRAPHRAG_EMBEDDING_THREAD_STAGGER=0.2
GRAPHRAG_EMBEDDING_CONCURRENT_REQUESTS=12
GRAPHRAG_EMBEDDING_TOKENS_PER_MINUTE=60000
GRAPHRAG_EMBEDDING_REQUESTS_PER_MINUTE=2000
GRAPHRAG_EXTRACT_MAX_GLEANINGS=1

# Neo4j Vector Indexes Configuration
CHUNK_VECTOR_INDEX_NAME=graphrag_chunk_index
CHUNK_VECTOR_INDEX_LABEL=__Chunk__
COMMUNITY_VECTOR_INDEX_NAME=graphrag_comm_index
COMMUNITY_VECTOR_INDEX_LABEL=__Community__
ENTITY_VECTOR_INDEX_NAME=graphrag_entity_index
ENTITY_VECTOR_INDEX_LABEL=__Entity__
VECTOR_INDEX_PROPERTY=embedding
VECTOR_INDEX_DIMENSIONS=1536
VECTOR_INDEX_SIMILARITY=cosine

# AI Workflow / GraphRAG Client Configuration
GRAPH_RAG_BASE_URL=http://neo4j-retrieval-service:8000
GRAPH_RAG_RETRIEVE_PATH=/retrieve
GRAPH_RAG_TIMEOUT_SEC=5.0
RETRIEVAL_MAX_ATTEMPTS=3
RETRIEVAL_BACKOFF_BASE_SEC=0.2

# --- Overriding the OIDC endpoint ---
# Use host.docker.internal so both host and containers resolve the same authority
# Mock auth publishes on host port 8005 per docker-compose.yml
AZURE_AD_AUTHORITY=http://host.docker.internal:8005
AZURE_TENANT_ID=e7963c3a-3b3a-43b6-9426-89e433d07e69
AZURE_CLIENT_ID=a9e304a9-5b6c-4ef7-9b37-23a579a6d7be

# Mock Authentication Configuration for E2E Tests
MOCK_CLIENT_SECRET=mock-secret
MOCK_SCOPE=api://a9e304a9-5b6c-4ef7-9b37-23a579a6d7be

# Azure Blob Storage Configuration (Azurite)
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://azurite:10000/devstoreaccount1;
AZURE_STORAGE_CONTAINER_NAME=documents
AZURE_STORAGE_ACCOUNT_NAME=devstoreaccount1
AZURE_STORAGE_ACCOUNT_KEY=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==
AZURE_STORAGE_BLOB_ENDPOINT=http://azurite:10000/devstoreaccount1
AZURE_STORAGE_MAX_SINGLE_PUT_SIZE=67108864
AZURE_STORAGE_MAX_BLOCK_SIZE=4194304

# Tika Configuration
TIKA_SERVER_JAR=/opt/tika-server/tika-server.jar
TIKA_SERVER_ENDPOINT=http://localhost:9998
TIKA_LOG_PATH=/tmp/tika-logs
TIKA_SERVER_TIMEOUT=300
TIKA_CLIENT_TIMEOUT=120
TIKA_VERSION=3.1.0
TIKA_CLIENT_ONLY=true
TIKA_SERVER_AUTO_START=true
TIKA_SERVER_STARTUP_TIMEOUT=60

# Backfill Description Configuration
BACKFILL_BATCH=100
BACKFILL_MAX_WORKERS=4